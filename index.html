<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>HVAC Digital Binder</title>

  <link rel="manifest" href="site.webmanifest">
  <link rel="icon" href="icons/icon-192.png">
  <link rel="apple-touch-icon" href="icons/icon-192.png">

  <style>
    /* Tiny inline debug HUD so you don't need DevTools */
    #dbg {
      position: fixed; left: 8px; right: 8px; bottom: 8px;
      background: rgba(0,0,0,.75); color: #fff; font: 12px/1.4 system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
      border-radius: 10px; padding: 8px 10px; z-index: 99999;
      box-shadow: 0 4px 16px rgba(0,0,0,.35);
    }
    #dbg b { color: #9cf; }
    #dbg small { opacity:.8 }
    #dbg pre { margin:6px 0 0; max-height: 30vh; overflow:auto; white-space: pre-wrap; }
  </style>

  <script>
    // --- Boot shim so HUD never gets stuck ---
    window.__APP_READY__ = false;
    if (typeof window.serializeAppState !== 'function') {
      window.serializeAppState = () => {
        try { return JSON.stringify(window.__APP_STATE__ || {}); } catch(_) { return '{}'; }
      };
    }
    window.__notifyAppReady = function () {
      window.__APP_READY__ = true;
      try { document.dispatchEvent(new Event('app:ready')); } catch (_) {}
    };
    // Simple on-page logger (tablet-friendly)
    window.__log = (msg) => {
      const el = document.getElementById('dbg-log');
      if (!el) return;
      const time = new Date().toLocaleTimeString();
      el.textContent += `\n[${time}] ${msg}`;
      el.scrollTop = el.scrollHeight;
    };
  </script>
</head>
<body>
  <!-- Your existing header / app UI renders above/below; we only add this debugger -->
  <div id="dbg">
    <b>Status:</b> <span id="dbg-status">Bootingâ€¦</span>
    <small> (Tap to hide)</small>
    <pre id="dbg-log"></pre>
  </div>
  <script>
    // Tap to hide HUD
    document.getElementById('dbg').addEventListener('click', e => {
      e.currentTarget.style.display = 'none';
    });
    document.addEventListener('app:ready', () => {
      document.getElementById('dbg-status').textContent = 'Ready';
      window.__log('App signaled ready.');
    });
  </script>

  <!-- Load order: save-manager first so it can listen, then app -->
  <script src="save-manager.js?v=6" defer></script>
  <script src="app.js?v=3.12" defer></script>
</body>
</html>
