PATCH INSTRUCTIONS (build4) — prevent "double-save" conflicts and "Saved (no network)" after the first save.

1) Keep the script tag INSIDE <head>:
   <script src="/save-manager.js?v=4" defer></script>

2) In your app.js, after:   let state = { ... };
   ADD exactly these two lines:
   window.state = state;
   window.serializeAppState = function () { return { ...state, version: 17 }; };

3) Modify API.load to capture serverVersion (optional but recommended).
   AFTER parsing JSON in load(), set:
   window._serverVersion = (data && data.serverVersion) ? data.serverVersion : (window._serverVersion || 0);

   Example:
   const res = await fetch("/.netlify/functions/load", { cache: "no-store" });
   const data = await res.json();
   window._serverVersion = data.serverVersion || 0;
   return data;

4) Replace your existing "save" function with this one (find the debounce save and REPLACE it):

   const save = debounce(async () => {
     status("Saving…");
     // Prefer the HUD's queue to avoid double-writing & 409s
     if (window.queueSaveNow) {
       window.queueSaveNow();   // lets save-manager handle serverVersion + retries
       return;
     }

     // Fallback if HUD not present
     const payload = { ...state, version: 17, serverVersion: (window._serverVersion || 0) };
     try {
       const res = await fetch("/.netlify/functions/save", {
         method: "POST",
         headers: { "Content-Type": "application/json", "Cache-Control": "no-store" },
         body: JSON.stringify(payload),
         keepalive: true
       });
       if (!res.ok) throw new Error("save failed");
       const body = await res.json();
       if (body && body.ok) {
         window._serverVersion = body.serverVersion || ((window._serverVersion || 0) + 1);
         status("Saved");
       } else {
         status("Saved locally — will retry");
         localStorage.setItem("binder-data", JSON.stringify(payload));
       }
     } catch (err) {
       status("Saved locally — will retry");
       localStorage.setItem("binder-data", JSON.stringify(payload));
     }
   }, 300);

5) Bust PWA/service-worker cache while testing:
   - Open your site with:   https://YOUR-SITE.netlify.app/?v=build4
   - If you use Add-to-Home-Screen, open in the browser first with ?v=build4, then fully close and reopen the app.

Why this fixes your symptom:
- Previously both your app's save() and the HUD were POSTing. The second POST often hit a different serverVersion and came back 409 or a race, pushing your code into the localStorage branch => "Saved (no network)".
- With this patch, your save() delegates to the HUD (single writer). The HUD sends the current serverVersion, updates it from the server reply, and shows accurate status.
